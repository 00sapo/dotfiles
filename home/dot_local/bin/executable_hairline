#!/usr/bin/env python3

import tkinter as tk
import argparse


class CrosshairApp:
    def __init__(self, root, thickness):
        self.root = root
        self.root.withdraw()

        self.period = 16  # polling period in milliseconds
        self.colour = "#7F7F7F"
        self.thickness = thickness

        self.hlineL = tk.Toplevel(root)
        self.hlineR = tk.Toplevel(root)
        self.vlineT = tk.Toplevel(root)
        self.vlineB = tk.Toplevel(root)

        for line in [self.hlineL, self.hlineR, self.vlineT, self.vlineB]:
            line.overrideredirect(True)
            line.attributes("-topmost", True)
            line.configure(bg=self.colour)

        self.move_offscreen()
        self.update_crosshairs()

    def move_offscreen(self):
        for line in [self.hlineL, self.hlineR, self.vlineT, self.vlineB]:
            line.geometry("0x0+-1+-1")

    def update_crosshairs(self):
        x, y = self.root.winfo_pointerxy()

        if x == -1 or y == -1:
            self.move_offscreen()
        else:
            screen_width = self.root.winfo_screenwidth()
            screen_height = self.root.winfo_screenheight()

            self.hlineL.geometry(f"{x}x{self.thickness}+{0 if x > 0 else -1}+{y}")
            self.hlineR.geometry(f"{screen_width - x}x{self.thickness}+{x + 1}+{y}")

            self.vlineT.geometry(f"{self.thickness}x{y}+{x}+{0 if y > 0 else -1}")
            self.vlineB.geometry(f"{self.thickness}x{screen_height - y}+{x}+{y + 1}")

        self.root.after(self.period, self.update_crosshairs)


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Full-screen crosshairs")
    parser.add_argument(
        "-t", "--thickness", type=int, default=3, help="Thickness of the crosshairs"
    )
    args = parser.parse_args()

    root = tk.Tk()
    app = CrosshairApp(root, args.thickness)
    root.mainloop()
